{
  "views": {
    "v_analyses_stats": {
      "comment": "Daily statistics for monitoring",
      "definition": " SELECT date(dermadoc_analyses.created_at) AS date,\n    count(*) AS total_analyses,\n    count(*) FILTER (WHERE (dermadoc_analyses.status = 'completed'::text)) AS completed,\n    count(*) FILTER (WHERE (dermadoc_analyses.status = 'failed'::text)) AS failed,\n    avg(dermadoc_analyses.risk_score) FILTER (WHERE (dermadoc_analyses.status = 'completed'::text)) AS avg_risk_score,\n    count(*) FILTER (WHERE (dermadoc_analyses.classification = 'CRÍTICO'::text)) AS critical_cases,\n    count(*) FILTER (WHERE (dermadoc_analyses.classification = 'ALTO'::text)) AS high_risk_cases,\n    count(*) FILTER (WHERE (dermadoc_analyses.classification = 'MODERADO'::text)) AS moderate_cases,\n    count(*) FILTER (WHERE (dermadoc_analyses.classification = 'BAIXO'::text)) AS low_risk_cases,\n    avg(dermadoc_analyses.processing_duration_seconds) AS avg_duration_seconds\n   FROM dermadoc_analyses\n  GROUP BY (date(dermadoc_analyses.created_at))\n  ORDER BY (date(dermadoc_analyses.created_at)) DESC;"
    },
    "v_webhook_metrics": {
      "comment": null,
      "definition": " SELECT date_trunc('hour'::text, corev3_execution_logs.created_at) AS hour,\n    count(*) AS total_executions,\n    round(avg(corev3_execution_logs.duration_ms)) AS avg_duration_ms,\n    percentile_cont((0.95)::double precision) WITHIN GROUP (ORDER BY ((corev3_execution_logs.duration_ms)::double precision)) AS p95_duration_ms,\n    percentile_cont((0.99)::double precision) WITHIN GROUP (ORDER BY ((corev3_execution_logs.duration_ms)::double precision)) AS p99_duration_ms,\n    count(*) FILTER (WHERE ((corev3_execution_logs.status)::text = 'error'::text)) AS error_count,\n    count(*) FILTER (WHERE ((corev3_execution_logs.status)::text = 'success'::text)) AS success_count,\n    round(((100.0 * (count(*) FILTER (WHERE ((corev3_execution_logs.status)::text = 'success'::text)))::numeric) / (count(*))::numeric), 2) AS success_rate\n   FROM corev3_execution_logs\n  WHERE (((corev3_execution_logs.workflow_name)::text = 'Webhook Main'::text) AND (corev3_execution_logs.created_at > (now() - '7 days'::interval)))\n  GROUP BY (date_trunc('hour'::text, corev3_execution_logs.created_at))\n  ORDER BY (date_trunc('hour'::text, corev3_execution_logs.created_at)) DESC;"
    },
    "v_active_campaigns": {
      "comment": null,
      "definition": " SELECT c.id,\n    c.contact_id,\n    c.company_id,\n    c.config_id,\n    c.status,\n    c.steps_completed,\n    c.total_steps,\n    c.should_continue,\n    c.stopped_reason,\n    c.last_step_sent_at,\n    cfg.qualification_threshold,\n    cfg.disqualification_threshold,\n    COALESCE(ls.total_score, (0)::numeric) AS current_anum_score,\n    ls.qualification_stage,\n    ls.status AS lead_status,\n    cnt.opt_out\n   FROM (((corev4_followup_campaigns c\n     JOIN corev4_followup_configs cfg ON ((c.config_id = cfg.id)))\n     LEFT JOIN corev4_lead_state ls ON ((c.contact_id = ls.contact_id)))\n     LEFT JOIN corev4_contacts cnt ON ((c.contact_id = cnt.id)))\n  WHERE ((c.should_continue = true) AND ((c.status)::text = 'active'::text) AND (cnt.opt_out = false));"
    },
    "v_processing_queue": {
      "comment": "Real-time view of analyses in progress",
      "definition": " SELECT dermadoc_analyses.id,\n    dermadoc_analyses.user_id,\n    dermadoc_analyses.status,\n    dermadoc_analyses.image_type,\n    dermadoc_analyses.created_at,\n    dermadoc_analyses.processing_started_at,\n    (EXTRACT(epoch FROM (now() - dermadoc_analyses.processing_started_at)))::integer AS seconds_processing,\n    dermadoc_analyses.retry_count\n   FROM dermadoc_analyses\n  WHERE (dermadoc_analyses.status <> ALL (ARRAY['completed'::text, 'failed'::text]))\n  ORDER BY dermadoc_analyses.created_at;"
    },
    "corev4_contacts_readable": {
      "comment": null,
      "definition": " SELECT c.id,\n    c.company_id,\n    c.full_name,\n    c.whatsapp,\n    c.phone_number,\n    c.email,\n    c.origin_source,\n    c.utm_source,\n    c.utm_medium,\n    c.utm_campaign,\n    c.utm_adgroup,\n    c.utm_creative,\n    c.sector,\n    c.tags,\n    c.opt_out,\n    c.is_active,\n    c.created_at,\n    c.updated_at,\n    c.last_interaction_at,\n    to_char((c.created_at AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI:SS'::text) AS created_at_br,\n    to_char((c.updated_at AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI:SS'::text) AS updated_at_br,\n    to_char((c.last_interaction_at AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI:SS'::text) AS last_interaction_at_br,\n        CASE\n            WHEN (c.opt_out = true) THEN 'OPT-OUT'::text\n            ELSE 'ATIVO'::text\n        END AS status_readable,\n    ((EXTRACT(epoch FROM (now() - c.last_interaction_at)))::integer / 3600) AS hours_since_last_interaction\n   FROM corev4_contacts c;"
    },
    "corev4_lead_state_with_pain": {
      "comment": "Lead State com informações de categoria de dor para analytics (V4 Clean)",
      "definition": " SELECT ls.id,\n    ls.company_id,\n    ls.contact_id,\n    ls.authority_score,\n    ls.need_score,\n    ls.urgency_score,\n    ls.money_score,\n    ls.total_score,\n    ls.qualification_stage,\n    ls.is_qualified,\n    ls.status,\n    ls.analysis_count,\n    ls.last_analyzed_at,\n    ls.analyzed_at,\n    ls.created_at,\n    ls.updated_at,\n    ls.main_pain_category_id,\n    ls.main_pain_detail,\n    pc.category_key,\n    pc.category_label_pt AS pain_category_label,\n    pc.category_label_en AS pain_category_label_en,\n        CASE\n            WHEN (ls.main_pain_category_id IS NULL) THEN 'Não categorizado'::character varying\n            WHEN ((pc.category_key)::text = 'other'::text) THEN (ls.main_pain_detail)::character varying\n            ELSE pc.category_label_pt\n        END AS pain_display\n   FROM (corev4_lead_state ls\n     LEFT JOIN corev4_pain_categories pc ON ((ls.main_pain_category_id = pc.id)));"
    },
    "v_active_scheduled_meetings": {
      "comment": "All upcoming scheduled meetings with lead details",
      "definition": " SELECT sm.id,\n    sm.contact_id,\n    sm.company_id,\n    sm.meeting_date,\n    sm.meeting_end_date,\n    sm.meeting_duration_minutes,\n    sm.meeting_type,\n    sm.meeting_timezone,\n    sm.cal_booking_uid,\n    sm.cal_event_type_id,\n    sm.cal_event_title,\n    sm.cal_attendee_email,\n    sm.cal_attendee_name,\n    sm.cal_attendee_timezone,\n    sm.cal_location,\n    sm.cal_meeting_url,\n    sm.cal_reschedule_uid,\n    sm.cal_cancel_reason,\n    sm.cal_metadata,\n    sm.anum_score_at_booking,\n    sm.authority_score,\n    sm.need_score,\n    sm.urgency_score,\n    sm.money_score,\n    sm.qualification_stage,\n    sm.pain_category,\n    sm.conversation_summary,\n    sm.reminder_24h_sent,\n    sm.reminder_24h_sent_at,\n    sm.reminder_24h_delivery_status,\n    sm.reminder_1h_sent,\n    sm.reminder_1h_sent_at,\n    sm.reminder_1h_delivery_status,\n    sm.meeting_completed,\n    sm.meeting_completed_at,\n    sm.no_show,\n    sm.no_show_reported_at,\n    sm.meeting_notes,\n    sm.meeting_outcome,\n    sm.next_action,\n    sm.status,\n    sm.cancelled_at,\n    sm.cancelled_by,\n    sm.rescheduled_at,\n    sm.rescheduled_to,\n    sm.created_at,\n    sm.updated_at,\n    sm.created_by,\n    c.full_name,\n    c.whatsapp,\n    c.phone_number,\n    c.email,\n    ls.total_score AS current_anum_score,\n    ls.qualification_stage AS current_stage,\n    (EXTRACT(epoch FROM (sm.meeting_date - now())) / (3600)::numeric) AS hours_until_meeting\n   FROM ((corev4_scheduled_meetings sm\n     JOIN corev4_contacts c ON ((c.id = sm.contact_id)))\n     LEFT JOIN corev4_lead_state ls ON ((ls.contact_id = sm.contact_id)))\n  WHERE (((sm.status)::text = ANY ((ARRAY['scheduled'::character varying, 'confirmed'::character varying])::text[])) AND (sm.meeting_date > now()))\n  ORDER BY sm.meeting_date;"
    },
    "v_followup_execution_status": {
      "comment": "Debug view showing why each followup is or is not being executed",
      "definition": " SELECT e.id AS execution_id,\n    e.contact_id,\n    c.full_name,\n    c.whatsapp,\n    e.step,\n    e.scheduled_at,\n    e.executed,\n    e.should_send,\n    c.opt_out,\n    ls.total_score AS anum_score,\n    has_upcoming_meeting(c.id) AS has_upcoming_meeting,\n        CASE\n            WHEN e.executed THEN 'Already executed'::text\n            WHEN (NOT e.should_send) THEN 'Marked as should not send'::text\n            WHEN c.opt_out THEN 'Contact opted out'::text\n            WHEN has_upcoming_meeting(c.id) THEN 'Has upcoming meeting'::text\n            WHEN (c.last_interaction_at >= e.scheduled_at) THEN 'Lead responded after scheduling'::text\n            WHEN (e.scheduled_at > now()) THEN 'Not yet time to send'::text\n            ELSE 'Ready to send'::text\n        END AS execution_status,\n        CASE\n            WHEN has_upcoming_meeting(c.id) THEN 'Goal achieved: Meeting scheduled'::text\n            WHEN c.opt_out THEN 'Lead opted out'::text\n            WHEN (ls.total_score IS NULL) THEN 'Not yet analyzed'::text\n            WHEN (ls.total_score >= (70)::numeric) THEN 'Highly qualified - keep nurturing until meeting'::text\n            WHEN (ls.total_score >= (50)::numeric) THEN 'Qualified - keep nurturing'::text\n            WHEN (ls.total_score >= (30)::numeric) THEN 'Developing - continue followup'::text\n            ELSE 'Low fit - final attempts'::text\n        END AS followup_strategy\n   FROM ((corev4_followup_executions e\n     JOIN corev4_contacts c ON ((c.id = e.contact_id)))\n     LEFT JOIN corev4_lead_state ls ON ((ls.contact_id = e.contact_id)))\n  ORDER BY e.scheduled_at;"
    },
    "corev4_chat_history_readable": {
      "comment": null,
      "definition": " SELECT ch.id,\n    ch.session_id,\n    ch.contact_id,\n    ch.company_id,\n    ch.role,\n    ch.message,\n    ch.message_type,\n    ch.media_url,\n    ch.media_mime_type,\n    ch.tokens_used,\n    ch.cost_usd,\n    ch.model_used,\n    ch.message_timestamp,\n    ch.created_at,\n    ch.has_media,\n    to_char((ch.message_timestamp AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI:SS'::text) AS message_timestamp_br,\n    to_char((ch.created_at AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI:SS'::text) AS created_at_br,\n        CASE\n            WHEN ((ch.role)::text = 'human'::text) THEN 'Lead'::character varying\n            WHEN ((ch.role)::text = 'ai'::text) THEN 'Frank (Bot)'::character varying\n            ELSE ch.role\n        END AS role_readable\n   FROM corev4_chat_history ch;"
    },
    "v_meetings_needing_reminders": {
      "comment": "Meetings that need 24h or 1h reminders sent",
      "definition": " SELECT sm.id,\n    sm.contact_id,\n    sm.company_id,\n    sm.meeting_date,\n    sm.cal_meeting_url,\n    c.full_name AS contact_name,\n    c.whatsapp,\n    co.evolution_api_url,\n    co.evolution_instance,\n    co.evolution_api_key,\n        CASE\n            WHEN (((sm.meeting_date - '24:00:00'::interval) <= now()) AND (sm.reminder_24h_sent = false)) THEN '24h'::text\n            WHEN (((sm.meeting_date - '01:00:00'::interval) <= now()) AND (sm.reminder_1h_sent = false)) THEN '1h'::text\n            ELSE NULL::text\n        END AS reminder_type,\n    (EXTRACT(epoch FROM (sm.meeting_date - now())) / (3600)::numeric) AS hours_until_meeting\n   FROM ((corev4_scheduled_meetings sm\n     JOIN corev4_contacts c ON ((c.id = sm.contact_id)))\n     JOIN corev4_companies co ON ((co.id = sm.company_id)))\n  WHERE (((sm.status)::text = 'scheduled'::text) AND (sm.meeting_date > now()) AND ((((sm.meeting_date - '24:00:00'::interval) <= now()) AND (sm.reminder_24h_sent = false)) OR (((sm.meeting_date - '01:00:00'::interval) <= now()) AND (sm.reminder_1h_sent = false))))\n  ORDER BY sm.meeting_date;"
    },
    "v_pending_followup_executions": {
      "comment": null,
      "definition": " SELECT fe.id AS execution_id,\n    fe.campaign_id,\n    fe.contact_id,\n    fe.company_id,\n    fe.step,\n    fe.total_steps,\n    fe.scheduled_at,\n    fe.executed,\n    fe.should_send,\n    c.config_id,\n    cfg.qualification_threshold,\n    cfg.disqualification_threshold,\n    COALESCE(ls.total_score, (0)::numeric) AS current_anum_score,\n    ls.status AS lead_status,\n    cnt.opt_out,\n    cnt.full_name AS contact_name,\n    cnt.whatsapp\n   FROM ((((corev4_followup_executions fe\n     JOIN corev4_followup_campaigns c ON ((fe.campaign_id = c.id)))\n     JOIN corev4_followup_configs cfg ON ((c.config_id = cfg.id)))\n     LEFT JOIN corev4_lead_state ls ON ((fe.contact_id = ls.contact_id)))\n     LEFT JOIN corev4_contacts cnt ON ((fe.contact_id = cnt.id)))\n  WHERE ((fe.executed = false) AND (fe.should_send = true) AND (fe.scheduled_at <= now()) AND (cnt.opt_out = false) AND (c.should_continue = true));"
    },
    "corev4_followup_campaigns_readable": {
      "comment": null,
      "definition": " SELECT fc.id,\n    fc.contact_id,\n    fc.company_id,\n    fc.config_id,\n    fc.status,\n    fc.pause_reason,\n    fc.steps_completed,\n    fc.total_steps,\n    fc.last_step_sent_at,\n    fc.should_continue,\n    fc.stopped_reason,\n    fc.created_at,\n    fc.updated_at,\n    to_char((fc.created_at AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI:SS'::text) AS created_at_br,\n    to_char((fc.updated_at AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI:SS'::text) AS updated_at_br,\n    to_char((fc.last_step_sent_at AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI:SS'::text) AS last_step_sent_at_br,\n    concat(fc.steps_completed, '/', fc.total_steps) AS progress_readable,\n        CASE\n            WHEN (((fc.status)::text = 'active'::text) AND (fc.should_continue = true)) THEN 'ATIVO'::text\n            WHEN ((fc.status)::text = 'completed'::text) THEN 'CONCLUÍDO'::text\n            WHEN ((fc.status)::text = 'stopped'::text) THEN 'PARADO'::text\n            WHEN (((fc.status)::text = 'active'::text) AND (fc.should_continue = false)) THEN 'PAUSADO'::text\n            ELSE upper((fc.status)::text)\n        END AS status_readable\n   FROM corev4_followup_campaigns fc;"
    },
    "corev4_followup_configs_with_steps": {
      "comment": null,
      "definition": " SELECT c.id,\n    c.company_id,\n    c.total_steps,\n    c.is_active,\n    jsonb_object_agg(('step_'::text || s.step_number), ((s.wait_hours)::numeric + ((s.wait_minutes)::numeric / (60)::numeric))) AS timing_pattern,\n    c.created_at\n   FROM (corev4_followup_configs c\n     LEFT JOIN corev4_followup_steps s ON ((c.id = s.config_id)))\n  GROUP BY c.id, c.company_id, c.total_steps, c.is_active, c.created_at;"
    },
    "corev4_followup_executions_readable": {
      "comment": null,
      "definition": " SELECT e.id,\n    e.campaign_id,\n    e.contact_id,\n    e.company_id,\n    e.step,\n    e.total_steps,\n    e.scheduled_at,\n    e.executed,\n    e.sent_at,\n    e.generated_message,\n    e.generation_context,\n    e.should_send,\n    e.decision_reason,\n    e.anum_at_execution,\n    e.evolution_message_id,\n    e.evolution_api_url,\n    e.evolution_instance,\n    e.created_at,\n    e.updated_at,\n    to_char((e.scheduled_at AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI'::text) AS scheduled_at_br,\n    to_char((e.sent_at AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI'::text) AS sent_at_br,\n    to_char((e.created_at AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI:SS'::text) AS created_at_br,\n    to_char((e.updated_at AT TIME ZONE 'America/Sao_Paulo'::text), 'DD/MM/YYYY HH24:MI:SS'::text) AS updated_at_br,\n        CASE\n            WHEN ((e.executed = false) AND (e.scheduled_at <= now())) THEN 'ATRASADO'::text\n            WHEN ((e.executed = false) AND (e.scheduled_at > now())) THEN 'PENDENTE'::text\n            WHEN (e.executed = true) THEN 'ENVIADO'::text\n            ELSE 'DESCONHECIDO'::text\n        END AS status_readable,\n        CASE\n            WHEN ((e.executed = false) AND (e.scheduled_at <= now())) THEN (EXTRACT(epoch FROM (now() - e.scheduled_at)))::integer\n            ELSE NULL::integer\n        END AS delay_seconds\n   FROM corev4_followup_executions e;"
    }
  },
  "entities": {
    "corev4_chats": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_chats_id_seq'::regclass)",
          "nullable": false,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": false,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "agent_alias": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "closed_reason": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "last_message_ts": {
          "default": null,
          "nullable": true,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "batch_collecting": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "batch_expires_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "conversation_open": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "last_lead_message_ts": {
          "default": null,
          "nullable": true,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "last_agent_message_ts": {
          "default": null,
          "nullable": true,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_chats_pkey ON public.corev4_chats USING btree (id)",
          "index_name": "corev4_chats_pkey"
        },
        {
          "definition": "CREATE UNIQUE INDEX unique_contact_chat ON public.corev4_chats USING btree (contact_id, company_id)",
          "index_name": "unique_contact_chat"
        },
        {
          "definition": "CREATE INDEX idx_chats_contact ON public.corev4_chats USING btree (contact_id)",
          "index_name": "idx_chats_contact"
        },
        {
          "definition": "CREATE INDEX idx_chats_company ON public.corev4_chats USING btree (company_id)",
          "index_name": "idx_chats_company"
        },
        {
          "definition": "CREATE INDEX idx_chats_open ON public.corev4_chats USING btree (conversation_open) WHERE (conversation_open = true)",
          "index_name": "idx_chats_open"
        },
        {
          "definition": "CREATE INDEX idx_chats_batch ON public.corev4_chats USING btree (batch_collecting) WHERE (batch_collecting = true)",
          "index_name": "idx_chats_batch"
        },
        {
          "definition": "CREATE INDEX idx_chats_last_message ON public.corev4_chats USING btree (last_message_ts DESC NULLS LAST)",
          "index_name": "idx_chats_last_message"
        },
        {
          "definition": "CREATE INDEX idx_chats_conversation_open ON public.corev4_chats USING btree (conversation_open) WHERE (conversation_open = true)",
          "index_name": "idx_chats_conversation_open"
        }
      ],
      "triggers": [
        {
          "definition": "CREATE TRIGGER update_chats_updated_at BEFORE UPDATE ON public.corev4_chats FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()",
          "trigger_name": "update_chats_updated_at",
          "function_name": "update_updated_at_column",
          "trigger_event": "UPDATE",
          "trigger_timing": "BEFORE"
        }
      ],
      "row_count": 0,
      "total_size": "72 kB",
      "description": "Gerenciamento de conversas ativas",
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "CASCADE",
          "constraint_name": "fk_chats_company",
          "references_table": "corev4_companies",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_chats_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_629011_1_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_629011_2_not_null"
        },
        {
          "check_clause": "contact_id IS NOT NULL",
          "constraint_name": "2200_629011_3_not_null"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "contact_id",
            "company_id"
          ],
          "constraint_name": "unique_contact_chat"
        }
      ]
    },
    "corev4_contacts": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_contacts_id_seq'::regclass)",
          "nullable": false,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "tags": {
          "default": "'{}'::text[]",
          "nullable": true,
          "data_type": "ARRAY",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "email": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "sector": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "opt_out": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "whatsapp": {
          "default": null,
          "nullable": false,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "full_name": {
          "default": null,
          "nullable": false,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "is_active": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "utm_medium": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "utm_source": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "utm_adgroup": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "phone_number": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "utm_campaign": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "utm_creative": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "origin_source": {
          "default": "'whatsapp'::text",
          "nullable": false,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "last_interaction_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_contacts_pkey ON public.corev4_contacts USING btree (id)",
          "index_name": "corev4_contacts_pkey"
        },
        {
          "definition": "CREATE UNIQUE INDEX unique_whatsapp_company ON public.corev4_contacts USING btree (whatsapp, company_id)",
          "index_name": "unique_whatsapp_company"
        },
        {
          "definition": "CREATE INDEX idx_contacts_company ON public.corev4_contacts USING btree (company_id)",
          "index_name": "idx_contacts_company"
        },
        {
          "definition": "CREATE INDEX idx_contacts_whatsapp ON public.corev4_contacts USING btree (whatsapp)",
          "index_name": "idx_contacts_whatsapp"
        },
        {
          "definition": "CREATE INDEX idx_contacts_email ON public.corev4_contacts USING btree (email) WHERE (email IS NOT NULL)",
          "index_name": "idx_contacts_email"
        },
        {
          "definition": "CREATE INDEX idx_contacts_active ON public.corev4_contacts USING btree (is_active) WHERE (is_active = true)",
          "index_name": "idx_contacts_active"
        },
        {
          "definition": "CREATE INDEX idx_contacts_opt_out ON public.corev4_contacts USING btree (opt_out) WHERE (opt_out = false)",
          "index_name": "idx_contacts_opt_out"
        },
        {
          "definition": "CREATE INDEX idx_contacts_last_interaction ON public.corev4_contacts USING btree (last_interaction_at DESC NULLS LAST)",
          "index_name": "idx_contacts_last_interaction"
        },
        {
          "definition": "CREATE INDEX idx_contacts_full_name_trgm ON public.corev4_contacts USING gin (full_name gin_trgm_ops)",
          "index_name": "idx_contacts_full_name_trgm"
        },
        {
          "definition": "CREATE INDEX idx_contacts_created ON public.corev4_contacts USING btree (created_at DESC)",
          "index_name": "idx_contacts_created"
        }
      ],
      "triggers": [
        {
          "definition": "CREATE TRIGGER update_contacts_updated_at BEFORE UPDATE ON public.corev4_contacts FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()",
          "trigger_name": "update_contacts_updated_at",
          "function_name": "update_updated_at_column",
          "trigger_event": "UPDATE",
          "trigger_timing": "BEFORE"
        }
      ],
      "row_count": 0,
      "total_size": "96 kB",
      "description": "Contatos principais do sistema",
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "CASCADE",
          "constraint_name": "fk_contacts_company",
          "references_table": "corev4_companies",
          "references_column": "id"
        }
      ],
      "rls_policies": [
        {
          "roles": [
            "public"
          ],
          "operation": "ALL",
          "permissive": "PERMISSIVE",
          "policy_name": "tenant_isolation_contacts",
          "using_expression": "(company_id = (current_setting('app.current_company_id'::text, true))::integer)",
          "with_check_expression": null
        }
      ],
      "rls_policy_count": 1,
      "check_constraints": [
        {
          "check_clause": "(((email IS NULL) OR (email ~* '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$'::text)))",
          "constraint_name": "valid_email"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_628913_2_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_628913_1_not_null"
        },
        {
          "check_clause": "full_name IS NOT NULL",
          "constraint_name": "2200_628913_3_not_null"
        },
        {
          "check_clause": "whatsapp IS NOT NULL",
          "constraint_name": "2200_628913_4_not_null"
        },
        {
          "check_clause": "origin_source IS NOT NULL",
          "constraint_name": "2200_628913_7_not_null"
        },
        {
          "check_clause": "(((phone_number IS NULL) OR (length(phone_number) >= 10)))",
          "constraint_name": "valid_phone"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "whatsapp",
            "company_id"
          ],
          "constraint_name": "unique_whatsapp_company"
        }
      ]
    },
    "corev4_companies": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_companies_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "name": {
          "default": null,
          "nullable": false,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 255
        },
        "slug": {
          "default": null,
          "nullable": false,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 255
        },
        "bot_name": {
          "default": "'Frank'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "features": {
          "default": "'{}'::jsonb",
          "nullable": true,
          "data_type": "jsonb",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "is_active": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "llm_model": {
          "default": "'gpt-4-turbo'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "plan_tier": {
          "default": "'free'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "crm_api_key": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "billing_email": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 255
        },
        "system_prompt": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "trial_ends_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "llm_max_tokens": {
          "default": "1000",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "webhook_secret": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "bot_personality": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "crm_integration": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "crm_pipeline_id": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "llm_temperature": {
          "default": "0.7",
          "nullable": true,
          "data_type": "numeric",
          "numeric_precision": 3,
          "character_maximum_length": null
        },
        "greeting_message": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "suspended_reason": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "contact_type_mode": {
          "default": "'leads_only'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "evolution_api_key": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "evolution_api_url": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "evolution_instance": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "enable_anum_analysis": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "auto_create_campaigns": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "monthly_message_limit": {
          "default": "1000",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "current_month_messages": {
          "default": "0",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "enable_audio_responses": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "enable_media_processing": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "anum_threshold_qualified": {
          "default": "70",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "enable_command_processing": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "enable_followup_campaigns": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "default_followup_config_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "webhook_validation_enabled": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "anum_threshold_disqualified": {
          "default": "20",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE INDEX idx_companies_slug ON public.corev4_companies USING btree (slug)",
          "index_name": "idx_companies_slug"
        },
        {
          "definition": "CREATE INDEX idx_companies_is_active ON public.corev4_companies USING btree (is_active)",
          "index_name": "idx_companies_is_active"
        },
        {
          "definition": "CREATE INDEX idx_companies_plan_tier ON public.corev4_companies USING btree (plan_tier)",
          "index_name": "idx_companies_plan_tier"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_companies_pkey ON public.corev4_companies USING btree (id)",
          "index_name": "corev4_companies_pkey"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_companies_slug_key ON public.corev4_companies USING btree (slug)",
          "index_name": "corev4_companies_slug_key"
        }
      ],
      "triggers": [],
      "row_count": 1,
      "total_size": "96 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": false,
      "foreign_keys": [
        {
          "column": "default_followup_config_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_companies_default_followup_config_id_fkey",
          "references_table": "corev4_followup_configs",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "(((plan_tier)::text = ANY ((ARRAY['free'::character varying, 'starter'::character varying, 'pro'::character varying, 'enterprise'::character varying, 'custom'::character varying])::text[])))",
          "constraint_name": "corev4_companies_plan_tier_check"
        },
        {
          "check_clause": "(((anum_threshold_disqualified >= 0) AND (anum_threshold_disqualified <= 100)))",
          "constraint_name": "corev4_companies_anum_threshold_disqualified_check"
        },
        {
          "check_clause": "(((anum_threshold_qualified >= 0) AND (anum_threshold_qualified <= 100)))",
          "constraint_name": "corev4_companies_anum_threshold_qualified_check"
        },
        {
          "check_clause": "(((contact_type_mode)::text = ANY ((ARRAY['leads_only'::character varying, 'customers_only'::character varying, 'mixed'::character varying, 'saas_users'::character varying])::text[])))",
          "constraint_name": "corev4_companies_contact_type_mode_check"
        },
        {
          "check_clause": "((llm_max_tokens > 0))",
          "constraint_name": "corev4_companies_llm_max_tokens_check"
        },
        {
          "check_clause": "(((llm_temperature >= 0.0) AND (llm_temperature <= 1.0)))",
          "constraint_name": "corev4_companies_llm_temperature_check"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_630489_1_not_null"
        },
        {
          "check_clause": "name IS NOT NULL",
          "constraint_name": "2200_630489_2_not_null"
        },
        {
          "check_clause": "slug IS NOT NULL",
          "constraint_name": "2200_630489_3_not_null"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "slug"
          ],
          "constraint_name": "corev4_companies_slug_key"
        }
      ]
    },
    "corev4_lead_state": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_lead_state_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "status": {
          "default": "'cold'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": false,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "need_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "analyzed_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "money_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "total_score": {
          "default": null,
          "nullable": true,
          "data_type": "numeric",
          "numeric_precision": 5,
          "character_maximum_length": null
        },
        "is_qualified": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "urgency_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "analysis_count": {
          "default": "0",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "authority_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "last_analysis_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "last_analyzed_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "main_pain_detail": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "qualification_stage": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 20
        },
        "main_pain_category_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_lead_state_contact_id_key ON public.corev4_lead_state USING btree (contact_id)",
          "index_name": "corev4_lead_state_contact_id_key"
        },
        {
          "definition": "CREATE INDEX idx_lead_state_contact ON public.corev4_lead_state USING btree (contact_id)",
          "index_name": "idx_lead_state_contact"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_lead_state_pkey ON public.corev4_lead_state USING btree (id)",
          "index_name": "corev4_lead_state_pkey"
        },
        {
          "definition": "CREATE INDEX idx_lead_state_company ON public.corev4_lead_state USING btree (company_id)",
          "index_name": "idx_lead_state_company"
        },
        {
          "definition": "CREATE INDEX idx_lead_state_total_score ON public.corev4_lead_state USING btree (total_score DESC)",
          "index_name": "idx_lead_state_total_score"
        },
        {
          "definition": "CREATE INDEX idx_lead_state_stage ON public.corev4_lead_state USING btree (qualification_stage)",
          "index_name": "idx_lead_state_stage"
        },
        {
          "definition": "CREATE INDEX idx_lead_state_last_analyzed ON public.corev4_lead_state USING btree (last_analyzed_at)",
          "index_name": "idx_lead_state_last_analyzed"
        },
        {
          "definition": "CREATE INDEX idx_lead_state_pain_category ON public.corev4_lead_state USING btree (main_pain_category_id)",
          "index_name": "idx_lead_state_pain_category"
        },
        {
          "definition": "CREATE INDEX idx_lead_state_qualified ON public.corev4_lead_state USING btree (is_qualified, company_id, total_score DESC)",
          "index_name": "idx_lead_state_qualified"
        }
      ],
      "triggers": [
        {
          "definition": "CREATE TRIGGER calculate_lead_state_score BEFORE INSERT OR UPDATE ON public.corev4_lead_state FOR EACH ROW EXECUTE FUNCTION calculate_anum_total_score()",
          "trigger_name": "calculate_lead_state_score",
          "function_name": "calculate_anum_total_score",
          "trigger_event": "INSERT",
          "trigger_timing": "BEFORE"
        },
        {
          "definition": "CREATE TRIGGER update_lead_state_updated_at BEFORE UPDATE ON public.corev4_lead_state FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()",
          "trigger_name": "update_lead_state_updated_at",
          "function_name": "update_updated_at_column",
          "trigger_event": "UPDATE",
          "trigger_timing": "BEFORE"
        }
      ],
      "row_count": 0,
      "total_size": "80 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "CASCADE",
          "constraint_name": "fk_lead_state_contact",
          "references_table": "corev4_contacts",
          "references_column": "id"
        },
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "CASCADE",
          "constraint_name": "fk_lead_state_company",
          "references_table": "corev4_companies",
          "references_column": "id"
        },
        {
          "column": "main_pain_category_id",
          "on_delete": "SET NULL",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_lead_state_main_pain_category_id_fkey",
          "references_table": "corev4_pain_categories",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "(((need_score >= 0) AND (need_score <= 100)))",
          "constraint_name": "corev4_lead_state_need_score_check"
        },
        {
          "check_clause": "(((qualification_stage)::text = ANY ((ARRAY['pre'::character varying, 'partial'::character varying, 'full'::character varying, 'rejected'::character varying])::text[])))",
          "constraint_name": "corev4_lead_state_qualification_stage_check"
        },
        {
          "check_clause": "(((urgency_score >= 0) AND (urgency_score <= 100)))",
          "constraint_name": "corev4_lead_state_urgency_score_check"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_630549_1_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_630549_2_not_null"
        },
        {
          "check_clause": "contact_id IS NOT NULL",
          "constraint_name": "2200_630549_3_not_null"
        },
        {
          "check_clause": "((length(main_pain_detail) <= 200))",
          "constraint_name": "check_main_pain_detail_length"
        },
        {
          "check_clause": "(((authority_score >= 0) AND (authority_score <= 100)))",
          "constraint_name": "corev4_lead_state_authority_score_check"
        },
        {
          "check_clause": "(((money_score >= 0) AND (money_score <= 100)))",
          "constraint_name": "corev4_lead_state_money_score_check"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "contact_id"
          ],
          "constraint_name": "corev4_lead_state_contact_id_key"
        }
      ]
    },
    "corev4_ai_decisions": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_ai_decisions_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "cost_usd": {
          "default": null,
          "nullable": true,
          "data_type": "numeric",
          "numeric_precision": 10,
          "character_maximum_length": null
        },
        "decision": {
          "default": null,
          "nullable": false,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 30
        },
        "reasoning": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "model_used": {
          "default": null,
          "nullable": false,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "tokens_used": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "confidence_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "context_snapshot": {
          "default": null,
          "nullable": true,
          "data_type": "jsonb",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "processing_time_ms": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "followup_execution_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE INDEX idx_ai_decisions_execution ON public.corev4_ai_decisions USING btree (followup_execution_id, created_at DESC)",
          "index_name": "idx_ai_decisions_execution"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_ai_decisions_pkey ON public.corev4_ai_decisions USING btree (id)",
          "index_name": "corev4_ai_decisions_pkey"
        },
        {
          "definition": "CREATE INDEX idx_ai_decisions_exec ON public.corev4_ai_decisions USING btree (followup_execution_id)",
          "index_name": "idx_ai_decisions_exec"
        },
        {
          "definition": "CREATE INDEX idx_ai_decisions_model ON public.corev4_ai_decisions USING btree (model_used)",
          "index_name": "idx_ai_decisions_model"
        },
        {
          "definition": "CREATE INDEX idx_ai_decisions_decision ON public.corev4_ai_decisions USING btree (decision)",
          "index_name": "idx_ai_decisions_decision"
        },
        {
          "definition": "CREATE INDEX idx_ai_decisions_created ON public.corev4_ai_decisions USING btree (created_at DESC)",
          "index_name": "idx_ai_decisions_created"
        },
        {
          "definition": "CREATE INDEX idx_ai_cost_analytics ON public.corev4_ai_decisions USING btree (model_used, decision, created_at DESC)",
          "index_name": "idx_ai_cost_analytics"
        },
        {
          "definition": "CREATE INDEX idx_ai_execution_link ON public.corev4_ai_decisions USING btree (followup_execution_id, created_at DESC)",
          "index_name": "idx_ai_execution_link"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "72 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "followup_execution_id",
          "on_delete": "SET NULL",
          "on_update": "CASCADE",
          "constraint_name": "fk_ai_decisions_followup_execution",
          "references_table": "corev4_followup_executions",
          "references_column": "id"
        },
        {
          "column": "followup_execution_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "fk_followup_execution",
          "references_table": "corev4_followup_executions",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "decision IS NOT NULL",
          "constraint_name": "2200_630784_4_not_null"
        },
        {
          "check_clause": "model_used IS NOT NULL",
          "constraint_name": "2200_630784_3_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_630784_1_not_null"
        },
        {
          "check_clause": "(((confidence_score >= 0) AND (confidence_score <= 100)))",
          "constraint_name": "corev4_ai_decisions_confidence_score_check"
        }
      ],
      "unique_constraints": []
    },
    "corev4_anum_history": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_anum_history_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "evidence": {
          "default": null,
          "nullable": true,
          "data_type": "jsonb",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": false,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "need_delta": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "need_score": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "analyzed_at": {
          "default": "now()",
          "nullable": false,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "money_delta": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "money_score": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "total_score": {
          "default": null,
          "nullable": false,
          "data_type": "numeric",
          "numeric_precision": 5,
          "character_maximum_length": null
        },
        "is_qualified": {
          "default": "false",
          "nullable": false,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "urgency_delta": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "urgency_score": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "trigger_source": {
          "default": "'anum_analyzer'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "authority_delta": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "authority_score": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "confidence_score": {
          "default": null,
          "nullable": true,
          "data_type": "numeric",
          "numeric_precision": 3,
          "character_maximum_length": null
        },
        "main_pain_detail": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "messages_analyzed": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "analysis_reasoning": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "qualification_stage": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 20
        },
        "main_pain_category_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE INDEX idx_anum_history_pain_category ON public.corev4_anum_history USING btree (main_pain_category_id)",
          "index_name": "idx_anum_history_pain_category"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_anum_history_pkey ON public.corev4_anum_history USING btree (id)",
          "index_name": "corev4_anum_history_pkey"
        },
        {
          "definition": "CREATE INDEX idx_anum_history_contact ON public.corev4_anum_history USING btree (contact_id)",
          "index_name": "idx_anum_history_contact"
        },
        {
          "definition": "CREATE INDEX idx_anum_history_company ON public.corev4_anum_history USING btree (company_id)",
          "index_name": "idx_anum_history_company"
        },
        {
          "definition": "CREATE INDEX idx_anum_history_analyzed_at ON public.corev4_anum_history USING btree (analyzed_at DESC)",
          "index_name": "idx_anum_history_analyzed_at"
        },
        {
          "definition": "CREATE INDEX idx_anum_history_qualified ON public.corev4_anum_history USING btree (is_qualified)",
          "index_name": "idx_anum_history_qualified"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "56 kB",
      "description": "Histórico de análises ANUM - auditoria completa de qualificação de leads",
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_anum_history_company_id_fkey",
          "references_table": "corev4_companies",
          "references_column": "id"
        },
        {
          "column": "main_pain_category_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_anum_history_main_pain_category_id_fkey",
          "references_table": "corev4_pain_categories",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_anum_history_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "need_score IS NOT NULL",
          "constraint_name": "2200_647337_5_not_null"
        },
        {
          "check_clause": "urgency_score IS NOT NULL",
          "constraint_name": "2200_647337_6_not_null"
        },
        {
          "check_clause": "(((urgency_score >= 0) AND (urgency_score <= 100)))",
          "constraint_name": "corev4_anum_history_urgency_score_check"
        },
        {
          "check_clause": "(((authority_score >= 0) AND (authority_score <= 100)))",
          "constraint_name": "corev4_anum_history_authority_score_check"
        },
        {
          "check_clause": "(((confidence_score >= (0)::numeric) AND (confidence_score <= (1)::numeric)))",
          "constraint_name": "corev4_anum_history_confidence_score_check"
        },
        {
          "check_clause": "(((money_score >= 0) AND (money_score <= 100)))",
          "constraint_name": "corev4_anum_history_money_score_check"
        },
        {
          "check_clause": "(((need_score >= 0) AND (need_score <= 100)))",
          "constraint_name": "corev4_anum_history_need_score_check"
        },
        {
          "check_clause": "(((qualification_stage)::text = ANY ((ARRAY['pre'::character varying, 'partial'::character varying, 'full'::character varying, 'rejected'::character varying])::text[])))",
          "constraint_name": "corev4_anum_history_qualification_stage_check"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_647337_1_not_null"
        },
        {
          "check_clause": "contact_id IS NOT NULL",
          "constraint_name": "2200_647337_2_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_647337_3_not_null"
        },
        {
          "check_clause": "authority_score IS NOT NULL",
          "constraint_name": "2200_647337_4_not_null"
        },
        {
          "check_clause": "created_at IS NOT NULL",
          "constraint_name": "2200_647337_21_not_null"
        },
        {
          "check_clause": "analyzed_at IS NOT NULL",
          "constraint_name": "2200_647337_20_not_null"
        },
        {
          "check_clause": "messages_analyzed IS NOT NULL",
          "constraint_name": "2200_647337_13_not_null"
        },
        {
          "check_clause": "is_qualified IS NOT NULL",
          "constraint_name": "2200_647337_9_not_null"
        },
        {
          "check_clause": "total_score IS NOT NULL",
          "constraint_name": "2200_647337_8_not_null"
        },
        {
          "check_clause": "money_score IS NOT NULL",
          "constraint_name": "2200_647337_7_not_null"
        }
      ],
      "unique_constraints": []
    },
    "corev4_chat_history": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_chat_history_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "role": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "message": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cost_usd": {
          "default": null,
          "nullable": true,
          "data_type": "numeric",
          "numeric_precision": 10,
          "character_maximum_length": null
        },
        "has_media": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "media_url": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "model_used": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "session_id": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 255
        },
        "tokens_used": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "message_type": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "media_mime_type": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "message_timestamp": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE INDEX idx_chat_session_time ON public.corev4_chat_history USING btree (session_id, created_at DESC)",
          "index_name": "idx_chat_session_time"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_chat_history_pkey ON public.corev4_chat_history USING btree (id)",
          "index_name": "corev4_chat_history_pkey"
        },
        {
          "definition": "CREATE INDEX idx_chat_history_session ON public.corev4_chat_history USING btree (session_id)",
          "index_name": "idx_chat_history_session"
        },
        {
          "definition": "CREATE INDEX idx_chat_history_contact ON public.corev4_chat_history USING btree (contact_id)",
          "index_name": "idx_chat_history_contact"
        },
        {
          "definition": "CREATE INDEX idx_chat_history_contact_company ON public.corev4_chat_history USING btree (contact_id, company_id)",
          "index_name": "idx_chat_history_contact_company"
        },
        {
          "definition": "CREATE INDEX idx_chat_history_has_media ON public.corev4_chat_history USING btree (has_media) WHERE (has_media = true)",
          "index_name": "idx_chat_history_has_media"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "56 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "CASCADE",
          "constraint_name": "fk_chat_history_company",
          "references_table": "corev4_companies",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "CASCADE",
          "constraint_name": "fk_chat_history_contact",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "contact_id IS NOT NULL",
          "constraint_name": "2200_635213_3_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_635213_4_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_635213_1_not_null"
        }
      ],
      "unique_constraints": []
    },
    "corev4_message_dedup": {
      "type": "table",
      "columns": {
        "processed": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": false,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "message_id": {
          "default": null,
          "nullable": false,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "received_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "whatsapp_id": {
          "default": null,
          "nullable": false,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "received_at_second": {
          "default": null,
          "nullable": true,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "workflow_execution_id": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE INDEX idx_message_dedup_created ON public.corev4_message_dedup USING btree (created_at)",
          "index_name": "idx_message_dedup_created"
        },
        {
          "definition": "CREATE INDEX idx_message_dedup_whatsapp_time ON public.corev4_message_dedup USING btree (whatsapp_id, received_at DESC, company_id)",
          "index_name": "idx_message_dedup_whatsapp_time"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_message_dedup_pkey ON public.corev4_message_dedup USING btree (message_id)",
          "index_name": "corev4_message_dedup_pkey"
        },
        {
          "definition": "CREATE INDEX idx_dedup_received ON public.corev4_message_dedup USING btree (received_at DESC)",
          "index_name": "idx_dedup_received"
        },
        {
          "definition": "CREATE INDEX idx_dedup_contact ON public.corev4_message_dedup USING btree (contact_id, received_at DESC)",
          "index_name": "idx_dedup_contact"
        },
        {
          "definition": "CREATE UNIQUE INDEX idx_dedup_whatsapp_second ON public.corev4_message_dedup USING btree (whatsapp_id, received_at_second)",
          "index_name": "idx_dedup_whatsapp_second"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "56 kB",
      "description": null,
      "primary_key": [
        "message_id"
      ],
      "rls_enabled": false,
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "CASCADE",
          "constraint_name": "fk_message_dedup_company",
          "references_table": "corev4_companies",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "fk_dedup_contact",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "message_id IS NOT NULL",
          "constraint_name": "2200_642026_1_not_null"
        },
        {
          "check_clause": "whatsapp_id IS NOT NULL",
          "constraint_name": "2200_642026_2_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_642026_4_not_null"
        },
        {
          "check_clause": "created_at IS NOT NULL",
          "constraint_name": "2200_642026_9_not_null"
        }
      ],
      "unique_constraints": []
    },
    "corev4_message_media": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_message_media_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "width": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "height": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "ai_tags": {
          "default": null,
          "nullable": true,
          "data_type": "ARRAY",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "ocr_text": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "embedding": {
          "default": null,
          "nullable": true,
          "data_type": "USER-DEFINED",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "file_size": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "mime_type": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "created_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "media_type": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "message_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "storage_url": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "original_url": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "storage_path": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "transcription": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "ai_description": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "thumbnail_path": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "storage_provider": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE INDEX idx_message_media_message ON public.corev4_message_media USING btree (message_id, company_id)",
          "index_name": "idx_message_media_message"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_message_media_pkey ON public.corev4_message_media USING btree (id)",
          "index_name": "corev4_message_media_pkey"
        },
        {
          "definition": "CREATE INDEX idx_message_media_company_message ON public.corev4_message_media USING btree (company_id, message_id)",
          "index_name": "idx_message_media_company_message"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "32 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "message_id",
          "on_delete": "CASCADE",
          "on_update": "CASCADE",
          "constraint_name": "fk_message_media_message",
          "references_table": "corev4_chat_history",
          "references_column": "id"
        },
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "CASCADE",
          "constraint_name": "fk_message_media_company",
          "references_table": "corev4_companies",
          "references_column": "id"
        }
      ],
      "rls_policies": [
        {
          "roles": [
            "public"
          ],
          "operation": "ALL",
          "permissive": "PERMISSIVE",
          "policy_name": "tenant_isolation_message_media",
          "using_expression": "(company_id = (current_setting('app.current_company_id'::text, true))::integer)",
          "with_check_expression": null
        }
      ],
      "rls_policy_count": 1,
      "check_constraints": [
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_649329_1_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_649329_19_not_null"
        }
      ],
      "unique_constraints": []
    },
    "corev4_contact_extras": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_contact_extras_id_seq'::regclass)",
          "nullable": false,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "crm_id": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "deals_id": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "plan_tier": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "stripe_id": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "thread_id": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": false,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "pipeline_id": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "interactions": {
          "default": "0",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "text_response": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "audio_response": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "last_interaction_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "evolution_api_contact": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_contact_extras_pkey ON public.corev4_contact_extras USING btree (id)",
          "index_name": "corev4_contact_extras_pkey"
        },
        {
          "definition": "CREATE UNIQUE INDEX unique_contact_extras ON public.corev4_contact_extras USING btree (contact_id, company_id)",
          "index_name": "unique_contact_extras"
        },
        {
          "definition": "CREATE INDEX idx_extras_contact ON public.corev4_contact_extras USING btree (contact_id)",
          "index_name": "idx_extras_contact"
        },
        {
          "definition": "CREATE INDEX idx_extras_company ON public.corev4_contact_extras USING btree (company_id)",
          "index_name": "idx_extras_company"
        },
        {
          "definition": "CREATE INDEX idx_extras_crm ON public.corev4_contact_extras USING btree (crm_id) WHERE (crm_id IS NOT NULL)",
          "index_name": "idx_extras_crm"
        },
        {
          "definition": "CREATE INDEX idx_extras_stripe ON public.corev4_contact_extras USING btree (stripe_id) WHERE (stripe_id IS NOT NULL)",
          "index_name": "idx_extras_stripe"
        },
        {
          "definition": "CREATE INDEX idx_extras_last_interaction ON public.corev4_contact_extras USING btree (last_interaction_at DESC NULLS LAST)",
          "index_name": "idx_extras_last_interaction"
        },
        {
          "definition": "CREATE INDEX idx_contact_extras_contact ON public.corev4_contact_extras USING btree (contact_id, company_id)",
          "index_name": "idx_contact_extras_contact"
        }
      ],
      "triggers": [
        {
          "definition": "CREATE TRIGGER update_contact_extras_updated_at BEFORE UPDATE ON public.corev4_contact_extras FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()",
          "trigger_name": "update_contact_extras_updated_at",
          "function_name": "update_updated_at_column",
          "trigger_event": "UPDATE",
          "trigger_timing": "BEFORE"
        }
      ],
      "row_count": 0,
      "total_size": "72 kB",
      "description": "Dados extras e integrações de contatos",
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "CASCADE",
          "constraint_name": "fk_contact_extras_contact",
          "references_table": "corev4_contacts",
          "references_column": "id"
        },
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "CASCADE",
          "constraint_name": "fk_contact_extras_company",
          "references_table": "corev4_companies",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "((interactions >= 0))",
          "constraint_name": "corev4_contact_extras_interactions_check"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_628940_1_not_null"
        },
        {
          "check_clause": "contact_id IS NOT NULL",
          "constraint_name": "2200_628940_2_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_628940_3_not_null"
        },
        {
          "check_clause": "((plan_tier >= 0))",
          "constraint_name": "corev4_contact_extras_plan_tier_check"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "contact_id",
            "company_id"
          ],
          "constraint_name": "unique_contact_extras"
        }
      ]
    },
    "corev4_execution_logs": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_execution_logs_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "details": {
          "default": null,
          "nullable": true,
          "data_type": "jsonb",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "success": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "duration_ms": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "followup_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "action_taken": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "execution_id": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 255
        },
        "error_message": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "workflow_name": {
          "default": null,
          "nullable": false,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 255
        }
      },
      "indexes": [
        {
          "definition": "CREATE INDEX idx_logs_workflow_time ON public.corev4_execution_logs USING btree (workflow_name, created_at DESC)",
          "index_name": "idx_logs_workflow_time"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_execution_logs_pkey ON public.corev4_execution_logs USING btree (id)",
          "index_name": "corev4_execution_logs_pkey"
        },
        {
          "definition": "CREATE INDEX idx_execution_logs_workflow ON public.corev4_execution_logs USING btree (workflow_name)",
          "index_name": "idx_execution_logs_workflow"
        },
        {
          "definition": "CREATE INDEX idx_execution_logs_contact ON public.corev4_execution_logs USING btree (contact_id)",
          "index_name": "idx_execution_logs_contact"
        },
        {
          "definition": "CREATE INDEX idx_execution_logs_followup ON public.corev4_execution_logs USING btree (followup_id)",
          "index_name": "idx_execution_logs_followup"
        },
        {
          "definition": "CREATE INDEX idx_execution_logs_success ON public.corev4_execution_logs USING btree (success)",
          "index_name": "idx_execution_logs_success"
        },
        {
          "definition": "CREATE INDEX idx_execution_logs_created ON public.corev4_execution_logs USING btree (created_at DESC)",
          "index_name": "idx_execution_logs_created"
        },
        {
          "definition": "CREATE INDEX idx_logs_analytics ON public.corev4_execution_logs USING btree (success, workflow_name, created_at DESC) WHERE (success = true)",
          "index_name": "idx_logs_analytics"
        },
        {
          "definition": "CREATE INDEX idx_logs_errors ON public.corev4_execution_logs USING btree (success, workflow_name, created_at DESC) WHERE (success = false)",
          "index_name": "idx_logs_errors"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "80 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": false,
      "foreign_keys": [
        {
          "column": "contact_id",
          "on_delete": "SET NULL",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_execution_logs_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        },
        {
          "column": "followup_id",
          "on_delete": "SET NULL",
          "on_update": "NO ACTION",
          "constraint_name": "fk_followup",
          "references_table": "corev4_followup_executions",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "SET NULL",
          "on_update": "NO ACTION",
          "constraint_name": "fk_contact",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "workflow_name IS NOT NULL",
          "constraint_name": "2200_630804_2_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_630804_1_not_null"
        }
      ],
      "unique_constraints": []
    },
    "corev4_followup_steps": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_followup_steps_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "config_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "wait_hours": {
          "default": "0",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "step_number": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "wait_minutes": {
          "default": "0",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_followup_steps_pkey ON public.corev4_followup_steps USING btree (id)",
          "index_name": "corev4_followup_steps_pkey"
        },
        {
          "definition": "CREATE UNIQUE INDEX unique_step_per_config ON public.corev4_followup_steps USING btree (config_id, step_number)",
          "index_name": "unique_step_per_config"
        },
        {
          "definition": "CREATE INDEX idx_followup_steps_config ON public.corev4_followup_steps USING btree (config_id)",
          "index_name": "idx_followup_steps_config"
        },
        {
          "definition": "CREATE INDEX idx_followup_steps_step ON public.corev4_followup_steps USING btree (step_number)",
          "index_name": "idx_followup_steps_step"
        }
      ],
      "triggers": [],
      "row_count": 5,
      "total_size": "72 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "config_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_steps_config_id_fkey",
          "references_table": "corev4_followup_configs",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "step_number IS NOT NULL",
          "constraint_name": "2200_649634_3_not_null"
        },
        {
          "check_clause": "(((wait_hours >= 0) AND (wait_minutes >= 0)))",
          "constraint_name": "valid_timing"
        },
        {
          "check_clause": "((step_number > 0))",
          "constraint_name": "valid_step_number"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_649634_1_not_null"
        },
        {
          "check_clause": "config_id IS NOT NULL",
          "constraint_name": "2200_649634_2_not_null"
        },
        {
          "check_clause": "wait_hours IS NOT NULL",
          "constraint_name": "2200_649634_4_not_null"
        },
        {
          "check_clause": "wait_minutes IS NOT NULL",
          "constraint_name": "2200_649634_5_not_null"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "config_id",
            "step_number"
          ],
          "constraint_name": "unique_step_per_config"
        }
      ]
    },
    "corev4_meeting_offers": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_meeting_offers_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "link_sent": {
          "default": "'https://cal.com/francisco-pasteur-coreadapt/mesa-de-clareza-45min'::text",
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "booking_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": false,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "need_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "offered_at": {
          "default": "now()",
          "nullable": false,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "offered_by": {
          "default": "'frank_ai'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "lead_booked": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "money_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "lead_clicked": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "offer_message": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "urgency_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "lead_booked_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "authority_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "lead_clicked_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "offered_in_flow": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "anum_score_at_offer": {
          "default": null,
          "nullable": true,
          "data_type": "numeric",
          "numeric_precision": 5,
          "character_maximum_length": null
        },
        "qualification_stage": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_meeting_offers_pkey ON public.corev4_meeting_offers USING btree (id)",
          "index_name": "corev4_meeting_offers_pkey"
        },
        {
          "definition": "CREATE INDEX idx_meeting_offers_contact ON public.corev4_meeting_offers USING btree (contact_id)",
          "index_name": "idx_meeting_offers_contact"
        },
        {
          "definition": "CREATE INDEX idx_meeting_offers_company ON public.corev4_meeting_offers USING btree (company_id)",
          "index_name": "idx_meeting_offers_company"
        },
        {
          "definition": "CREATE INDEX idx_meeting_offers_offered_at ON public.corev4_meeting_offers USING btree (offered_at DESC)",
          "index_name": "idx_meeting_offers_offered_at"
        },
        {
          "definition": "CREATE INDEX idx_meeting_offers_booked ON public.corev4_meeting_offers USING btree (lead_booked) WHERE (lead_booked = true)",
          "index_name": "idx_meeting_offers_booked"
        }
      ],
      "triggers": [
        {
          "definition": "CREATE TRIGGER set_timestamp_meeting_offers BEFORE UPDATE ON public.corev4_meeting_offers FOR EACH ROW EXECUTE FUNCTION trigger_set_timestamp()",
          "trigger_name": "set_timestamp_meeting_offers",
          "function_name": "trigger_set_timestamp",
          "trigger_event": "UPDATE",
          "trigger_timing": "BEFORE"
        }
      ],
      "row_count": 0,
      "total_size": "48 kB",
      "description": "Audit trail of all Mesa de Clareza offers sent to leads",
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_meeting_offers_company_id_fkey",
          "references_table": "corev4_companies",
          "references_column": "id"
        },
        {
          "column": "booking_id",
          "on_delete": "SET NULL",
          "on_update": "NO ACTION",
          "constraint_name": "fk_meeting_offers_booking",
          "references_table": "corev4_scheduled_meetings",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_meeting_offers_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "contact_id IS NOT NULL",
          "constraint_name": "2200_675997_2_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_675997_3_not_null"
        },
        {
          "check_clause": "offered_at IS NOT NULL",
          "constraint_name": "2200_675997_4_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_675997_1_not_null"
        }
      ],
      "unique_constraints": []
    },
    "corev4_pain_categories": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_pain_categories_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "keywords": {
          "default": "ARRAY[]::text[]",
          "nullable": false,
          "data_type": "ARRAY",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "is_active": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "description": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "category_key": {
          "default": null,
          "nullable": false,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "display_order": {
          "default": "0",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "category_label_en": {
          "default": null,
          "nullable": false,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "category_label_pt": {
          "default": null,
          "nullable": false,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_pain_categories_pkey ON public.corev4_pain_categories USING btree (id)",
          "index_name": "corev4_pain_categories_pkey"
        },
        {
          "definition": "CREATE UNIQUE INDEX unique_company_category ON public.corev4_pain_categories USING btree (company_id, category_key)",
          "index_name": "unique_company_category"
        },
        {
          "definition": "CREATE INDEX idx_pain_categories_company ON public.corev4_pain_categories USING btree (company_id)",
          "index_name": "idx_pain_categories_company"
        },
        {
          "definition": "CREATE INDEX idx_pain_categories_active ON public.corev4_pain_categories USING btree (company_id, is_active)",
          "index_name": "idx_pain_categories_active"
        },
        {
          "definition": "CREATE INDEX idx_pain_categories_key ON public.corev4_pain_categories USING btree (category_key)",
          "index_name": "idx_pain_categories_key"
        }
      ],
      "triggers": [],
      "row_count": 9,
      "total_size": "96 kB",
      "description": "Categorias pré-definidas de dores/problemas para classificação de leads",
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_pain_categories_company_id_fkey",
          "references_table": "corev4_companies",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_672858_1_not_null"
        },
        {
          "check_clause": "keywords IS NOT NULL",
          "constraint_name": "2200_672858_6_not_null"
        },
        {
          "check_clause": "category_key IS NOT NULL",
          "constraint_name": "2200_672858_3_not_null"
        },
        {
          "check_clause": "category_label_pt IS NOT NULL",
          "constraint_name": "2200_672858_4_not_null"
        },
        {
          "check_clause": "category_label_en IS NOT NULL",
          "constraint_name": "2200_672858_5_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_672858_2_not_null"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "company_id",
            "category_key"
          ],
          "constraint_name": "unique_company_category"
        }
      ]
    },
    "corev4_followup_configs": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_followup_configs_id_seq1'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "is_active": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "config_name": {
          "default": null,
          "nullable": false,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "total_steps": {
          "default": "5",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "max_no_response_days": {
          "default": "30",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "qualification_threshold": {
          "default": "60",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "disqualification_threshold": {
          "default": "15",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_followup_configs_pkey1 ON public.corev4_followup_configs USING btree (id)",
          "index_name": "corev4_followup_configs_pkey1"
        },
        {
          "definition": "CREATE INDEX idx_followup_configs_company ON public.corev4_followup_configs USING btree (company_id)",
          "index_name": "idx_followup_configs_company"
        },
        {
          "definition": "CREATE INDEX idx_followup_configs_active ON public.corev4_followup_configs USING btree (is_active) WHERE (is_active = true)",
          "index_name": "idx_followup_configs_active"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_followup_configs_company_name_key ON public.corev4_followup_configs USING btree (company_id, config_name)",
          "index_name": "corev4_followup_configs_company_name_key"
        }
      ],
      "triggers": [],
      "row_count": 1,
      "total_size": "80 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "CASCADE",
          "constraint_name": "fk_followup_configs_company",
          "references_table": "corev4_companies",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "total_steps IS NOT NULL",
          "constraint_name": "2200_636841_4_not_null"
        },
        {
          "check_clause": "config_name IS NOT NULL",
          "constraint_name": "2200_636841_3_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_636841_2_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_636841_1_not_null"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "company_id",
            "config_name"
          ],
          "constraint_name": "corev4_followup_configs_company_name_key"
        }
      ]
    },
    "corev4_followup_campaigns": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_followup_campaigns_id_seq1'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "status": {
          "default": "'active'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "config_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": false,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "total_steps": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "pause_reason": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "stopped_reason": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "should_continue": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "steps_completed": {
          "default": "0",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "last_step_sent_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_followup_campaigns_pkey1 ON public.corev4_followup_campaigns USING btree (id)",
          "index_name": "corev4_followup_campaigns_pkey1"
        },
        {
          "definition": "CREATE INDEX idx_campaigns_contact ON public.corev4_followup_campaigns USING btree (contact_id)",
          "index_name": "idx_campaigns_contact"
        },
        {
          "definition": "CREATE INDEX idx_campaigns_company ON public.corev4_followup_campaigns USING btree (company_id)",
          "index_name": "idx_campaigns_company"
        },
        {
          "definition": "CREATE INDEX idx_campaigns_config ON public.corev4_followup_campaigns USING btree (config_id)",
          "index_name": "idx_campaigns_config"
        },
        {
          "definition": "CREATE INDEX idx_campaigns_status ON public.corev4_followup_campaigns USING btree (status)",
          "index_name": "idx_campaigns_status"
        },
        {
          "definition": "CREATE INDEX idx_campaigns_active ON public.corev4_followup_campaigns USING btree (should_continue) WHERE (should_continue = true)",
          "index_name": "idx_campaigns_active"
        },
        {
          "definition": "CREATE INDEX idx_followup_campaigns_status ON public.corev4_followup_campaigns USING btree (status, company_id, should_continue)",
          "index_name": "idx_followup_campaigns_status"
        },
        {
          "definition": "CREATE INDEX idx_followup_campaigns_contact ON public.corev4_followup_campaigns USING btree (contact_id, company_id)",
          "index_name": "idx_followup_campaigns_contact"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "72 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "config_id",
          "on_delete": "RESTRICT",
          "on_update": "CASCADE",
          "constraint_name": "fk_followup_campaigns_config",
          "references_table": "corev4_followup_configs",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "CASCADE",
          "constraint_name": "fk_followup_campaigns_contact",
          "references_table": "corev4_contacts",
          "references_column": "id"
        },
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "CASCADE",
          "constraint_name": "fk_followup_campaigns_company",
          "references_table": "corev4_companies",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "contact_id IS NOT NULL",
          "constraint_name": "2200_636864_2_not_null"
        },
        {
          "check_clause": "total_steps IS NOT NULL",
          "constraint_name": "2200_636864_8_not_null"
        },
        {
          "check_clause": "config_id IS NOT NULL",
          "constraint_name": "2200_636864_4_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_636864_3_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_636864_1_not_null"
        }
      ],
      "unique_constraints": []
    },
    "corev4_followup_sequences": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_followup_sequences_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "campaign_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "step_number": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "interval_hours": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "max_anum_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "min_anum_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "required_stage": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 20
        },
        "message_template": {
          "default": null,
          "nullable": false,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_followup_sequences_pkey ON public.corev4_followup_sequences USING btree (id)",
          "index_name": "corev4_followup_sequences_pkey"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_followup_sequences_campaign_id_step_number_key ON public.corev4_followup_sequences USING btree (campaign_id, step_number)",
          "index_name": "corev4_followup_sequences_campaign_id_step_number_key"
        },
        {
          "definition": "CREATE INDEX idx_followup_sequences_campaign ON public.corev4_followup_sequences USING btree (campaign_id)",
          "index_name": "idx_followup_sequences_campaign"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "32 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "campaign_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "fk_sequences_campaign",
          "references_table": "corev4_followup_campaigns",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "message_template IS NOT NULL",
          "constraint_name": "2200_630707_5_not_null"
        },
        {
          "check_clause": "campaign_id IS NOT NULL",
          "constraint_name": "2200_630707_2_not_null"
        },
        {
          "check_clause": "step_number IS NOT NULL",
          "constraint_name": "2200_630707_3_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_630707_1_not_null"
        },
        {
          "check_clause": "interval_hours IS NOT NULL",
          "constraint_name": "2200_630707_4_not_null"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "campaign_id",
            "step_number"
          ],
          "constraint_name": "corev4_followup_sequences_campaign_id_step_number_key"
        }
      ]
    },
    "corev4_n8n_chat_histories": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_n8n_chat_histories_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "message": {
          "default": null,
          "nullable": false,
          "data_type": "jsonb",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": false,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "session_id": {
          "default": null,
          "nullable": false,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 255
        }
      },
      "indexes": [
        {
          "definition": "CREATE INDEX idx_n8n_chat_created ON public.corev4_n8n_chat_histories USING btree (created_at DESC)",
          "index_name": "idx_n8n_chat_created"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_n8n_chat_histories_pkey ON public.corev4_n8n_chat_histories USING btree (id)",
          "index_name": "corev4_n8n_chat_histories_pkey"
        },
        {
          "definition": "CREATE INDEX idx_n8n_chat_histories_session ON public.corev4_n8n_chat_histories USING btree (session_id)",
          "index_name": "idx_n8n_chat_histories_session"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "32 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": false,
      "foreign_keys": [],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "created_at IS NOT NULL",
          "constraint_name": "2200_635379_5_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_635379_1_not_null"
        },
        {
          "check_clause": "session_id IS NOT NULL",
          "constraint_name": "2200_635379_2_not_null"
        },
        {
          "check_clause": "message IS NOT NULL",
          "constraint_name": "2200_635379_3_not_null"
        }
      ],
      "unique_constraints": []
    },
    "corev4_scheduled_meetings": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_scheduled_meetings_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "status": {
          "default": "'scheduled'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 20
        },
        "no_show": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": false,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "created_by": {
          "default": "'cal_webhook'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "need_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "money_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "next_action": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cal_location": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cal_metadata": {
          "default": null,
          "nullable": true,
          "data_type": "jsonb",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cancelled_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cancelled_by": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "meeting_date": {
          "default": null,
          "nullable": false,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "meeting_type": {
          "default": "'mesa_clareza'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "meeting_notes": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "pain_category": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "urgency_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "rescheduled_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "rescheduled_to": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "authority_score": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "cal_booking_uid": {
          "default": null,
          "nullable": false,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cal_event_title": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cal_meeting_url": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "meeting_outcome": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "meeting_end_date": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "meeting_timezone": {
          "default": "'America/Sao_Paulo'::character varying",
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "reminder_1h_sent": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cal_attendee_name": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cal_cancel_reason": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cal_event_type_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "meeting_completed": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "reminder_24h_sent": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cal_attendee_email": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "cal_reschedule_uid": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "no_show_reported_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "qualification_stage": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "reminder_1h_sent_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "conversation_summary": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "meeting_completed_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "reminder_24h_sent_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "anum_score_at_booking": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "cal_attendee_timezone": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "meeting_duration_minutes": {
          "default": "45",
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "reminder_1h_delivery_status": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        },
        "reminder_24h_delivery_status": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 50
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_scheduled_meetings_pkey ON public.corev4_scheduled_meetings USING btree (id)",
          "index_name": "corev4_scheduled_meetings_pkey"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_scheduled_meetings_cal_booking_uid_key ON public.corev4_scheduled_meetings USING btree (cal_booking_uid)",
          "index_name": "corev4_scheduled_meetings_cal_booking_uid_key"
        },
        {
          "definition": "CREATE INDEX idx_scheduled_meetings_contact ON public.corev4_scheduled_meetings USING btree (contact_id)",
          "index_name": "idx_scheduled_meetings_contact"
        },
        {
          "definition": "CREATE INDEX idx_scheduled_meetings_company ON public.corev4_scheduled_meetings USING btree (company_id)",
          "index_name": "idx_scheduled_meetings_company"
        },
        {
          "definition": "CREATE INDEX idx_scheduled_meetings_date ON public.corev4_scheduled_meetings USING btree (meeting_date)",
          "index_name": "idx_scheduled_meetings_date"
        },
        {
          "definition": "CREATE INDEX idx_scheduled_meetings_status ON public.corev4_scheduled_meetings USING btree (status) WHERE ((status)::text = ANY ((ARRAY['scheduled'::character varying, 'confirmed'::character varying])::text[]))",
          "index_name": "idx_scheduled_meetings_status"
        },
        {
          "definition": "CREATE INDEX idx_scheduled_meetings_booking_uid ON public.corev4_scheduled_meetings USING btree (cal_booking_uid)",
          "index_name": "idx_scheduled_meetings_booking_uid"
        },
        {
          "definition": "CREATE INDEX idx_scheduled_meetings_upcoming ON public.corev4_scheduled_meetings USING btree (meeting_date, status) WHERE ((status)::text = ANY ((ARRAY['scheduled'::character varying, 'confirmed'::character varying])::text[]))",
          "index_name": "idx_scheduled_meetings_upcoming"
        },
        {
          "definition": "CREATE INDEX idx_scheduled_meetings_reminders ON public.corev4_scheduled_meetings USING btree (meeting_date, reminder_24h_sent, reminder_1h_sent, status) WHERE ((status)::text = 'scheduled'::text)",
          "index_name": "idx_scheduled_meetings_reminders"
        }
      ],
      "triggers": [
        {
          "definition": "CREATE TRIGGER set_timestamp_scheduled_meetings BEFORE UPDATE ON public.corev4_scheduled_meetings FOR EACH ROW EXECUTE FUNCTION trigger_set_timestamp()",
          "trigger_name": "set_timestamp_scheduled_meetings",
          "function_name": "trigger_set_timestamp",
          "trigger_event": "UPDATE",
          "trigger_timing": "BEFORE"
        },
        {
          "definition": "CREATE TRIGGER trigger_scheduled_meetings_updated_at BEFORE UPDATE ON public.corev4_scheduled_meetings FOR EACH ROW EXECUTE FUNCTION update_scheduled_meetings_updated_at()",
          "trigger_name": "trigger_scheduled_meetings_updated_at",
          "function_name": "update_scheduled_meetings_updated_at",
          "trigger_event": "UPDATE",
          "trigger_timing": "BEFORE"
        }
      ],
      "row_count": 0,
      "total_size": "80 kB",
      "description": "All scheduled Mesa de Clareza meetings from Cal.com",
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_scheduled_meetings_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        },
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_scheduled_meetings_company_id_fkey",
          "references_table": "corev4_companies",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "cal_booking_uid IS NOT NULL",
          "constraint_name": "2200_676026_9_not_null"
        },
        {
          "check_clause": "meeting_date IS NOT NULL",
          "constraint_name": "2200_676026_4_not_null"
        },
        {
          "check_clause": "contact_id IS NOT NULL",
          "constraint_name": "2200_676026_2_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_676026_3_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_676026_1_not_null"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "cal_booking_uid"
          ],
          "constraint_name": "corev4_scheduled_meetings_cal_booking_uid_key"
        }
      ]
    },
    "corev4_followup_executions": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_followup_executions_id_seq1'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "step": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "sent_at": {
          "default": null,
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "executed": {
          "default": "false",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "company_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": false,
          "data_type": "bigint",
          "numeric_precision": 64,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "updated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "campaign_id": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "should_send": {
          "default": "true",
          "nullable": true,
          "data_type": "boolean",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "total_steps": {
          "default": null,
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "scheduled_at": {
          "default": null,
          "nullable": false,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "decision_reason": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "anum_at_execution": {
          "default": null,
          "nullable": true,
          "data_type": "jsonb",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "evolution_api_url": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 255
        },
        "generated_message": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "evolution_instance": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 255
        },
        "generation_context": {
          "default": null,
          "nullable": true,
          "data_type": "jsonb",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "evolution_message_id": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 255
        }
      },
      "indexes": [
        {
          "definition": "CREATE INDEX idx_executions_lookup ON public.corev4_followup_executions USING btree (company_id, contact_id, executed) WHERE (executed = false)",
          "index_name": "idx_executions_lookup"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_followup_executions_pkey1 ON public.corev4_followup_executions USING btree (id)",
          "index_name": "corev4_followup_executions_pkey1"
        },
        {
          "definition": "CREATE INDEX idx_executions_campaign ON public.corev4_followup_executions USING btree (campaign_id)",
          "index_name": "idx_executions_campaign"
        },
        {
          "definition": "CREATE INDEX idx_executions_contact ON public.corev4_followup_executions USING btree (contact_id)",
          "index_name": "idx_executions_contact"
        },
        {
          "definition": "CREATE INDEX idx_executions_pending ON public.corev4_followup_executions USING btree (executed, scheduled_at, should_send) WHERE ((executed = false) AND (should_send = true))",
          "index_name": "idx_executions_pending"
        },
        {
          "definition": "CREATE INDEX idx_executions_scheduled ON public.corev4_followup_executions USING btree (scheduled_at)",
          "index_name": "idx_executions_scheduled"
        },
        {
          "definition": "CREATE INDEX idx_followup_executions_pending ON public.corev4_followup_executions USING btree (scheduled_at, executed, company_id) WHERE (executed = false)",
          "index_name": "idx_followup_executions_pending"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "64 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "CASCADE",
          "constraint_name": "fk_followup_executions_contact",
          "references_table": "corev4_contacts",
          "references_column": "id"
        },
        {
          "column": "campaign_id",
          "on_delete": "CASCADE",
          "on_update": "CASCADE",
          "constraint_name": "fk_followup_executions_campaign",
          "references_table": "corev4_followup_campaigns",
          "references_column": "id"
        },
        {
          "column": "company_id",
          "on_delete": "RESTRICT",
          "on_update": "CASCADE",
          "constraint_name": "fk_followup_executions_company",
          "references_table": "corev4_companies",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "total_steps IS NOT NULL",
          "constraint_name": "2200_636893_6_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_636893_1_not_null"
        },
        {
          "check_clause": "campaign_id IS NOT NULL",
          "constraint_name": "2200_636893_2_not_null"
        },
        {
          "check_clause": "contact_id IS NOT NULL",
          "constraint_name": "2200_636893_3_not_null"
        },
        {
          "check_clause": "company_id IS NOT NULL",
          "constraint_name": "2200_636893_4_not_null"
        },
        {
          "check_clause": "step IS NOT NULL",
          "constraint_name": "2200_636893_5_not_null"
        },
        {
          "check_clause": "scheduled_at IS NOT NULL",
          "constraint_name": "2200_636893_7_not_null"
        }
      ],
      "unique_constraints": []
    },
    "corev4_session_id_migration": {
      "type": "table",
      "columns": {
        "company_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "migrated_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "new_session_id": {
          "default": null,
          "nullable": false,
          "data_type": "uuid",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "old_session_id": {
          "default": null,
          "nullable": false,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_session_id_migration_pkey ON public.corev4_session_id_migration USING btree (old_session_id)",
          "index_name": "corev4_session_id_migration_pkey"
        },
        {
          "definition": "CREATE UNIQUE INDEX corev4_session_id_migration_new_session_id_key ON public.corev4_session_id_migration USING btree (new_session_id)",
          "index_name": "corev4_session_id_migration_new_session_id_key"
        },
        {
          "definition": "CREATE INDEX idx_session_migration_new ON public.corev4_session_id_migration USING btree (new_session_id)",
          "index_name": "idx_session_migration_new"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "32 kB",
      "description": null,
      "primary_key": [
        "old_session_id"
      ],
      "rls_enabled": false,
      "foreign_keys": [],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "old_session_id IS NOT NULL",
          "constraint_name": "2200_660619_1_not_null"
        },
        {
          "check_clause": "new_session_id IS NOT NULL",
          "constraint_name": "2200_660619_2_not_null"
        }
      ],
      "unique_constraints": [
        {
          "columns": [
            "new_session_id"
          ],
          "constraint_name": "corev4_session_id_migration_new_session_id_key"
        }
      ]
    },
    "corev4_followup_stage_history": {
      "type": "table",
      "columns": {
        "id": {
          "default": "nextval('corev4_followup_stage_history_id_seq'::regclass)",
          "nullable": false,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "notes": {
          "default": null,
          "nullable": true,
          "data_type": "text",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "new_stage": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 20
        },
        "old_stage": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 20
        },
        "changed_at": {
          "default": "now()",
          "nullable": true,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "changed_by": {
          "default": null,
          "nullable": true,
          "data_type": "character varying",
          "numeric_precision": null,
          "character_maximum_length": 100
        },
        "company_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "contact_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        },
        "created_at": {
          "default": "now()",
          "nullable": false,
          "data_type": "timestamp with time zone",
          "numeric_precision": null,
          "character_maximum_length": null
        },
        "followup_execution_id": {
          "default": null,
          "nullable": true,
          "data_type": "integer",
          "numeric_precision": 32,
          "character_maximum_length": null
        }
      },
      "indexes": [
        {
          "definition": "CREATE UNIQUE INDEX corev4_followup_stage_history_pkey ON public.corev4_followup_stage_history USING btree (id)",
          "index_name": "corev4_followup_stage_history_pkey"
        },
        {
          "definition": "CREATE INDEX idx_followup_stage_hist_contact ON public.corev4_followup_stage_history USING btree (contact_id)",
          "index_name": "idx_followup_stage_hist_contact"
        },
        {
          "definition": "CREATE INDEX idx_followup_stage_hist_exec ON public.corev4_followup_stage_history USING btree (followup_execution_id)",
          "index_name": "idx_followup_stage_hist_exec"
        },
        {
          "definition": "CREATE INDEX idx_followup_stage_hist_changed ON public.corev4_followup_stage_history USING btree (changed_at DESC)",
          "index_name": "idx_followup_stage_hist_changed"
        },
        {
          "definition": "CREATE INDEX idx_followup_stage_history_created ON public.corev4_followup_stage_history USING btree (created_at DESC)",
          "index_name": "idx_followup_stage_history_created"
        }
      ],
      "triggers": [],
      "row_count": 0,
      "total_size": "48 kB",
      "description": null,
      "primary_key": [
        "id"
      ],
      "rls_enabled": true,
      "foreign_keys": [
        {
          "column": "followup_execution_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "fk_stage_history_execution",
          "references_table": "corev4_followup_executions",
          "references_column": "id"
        },
        {
          "column": "company_id",
          "on_delete": "NO ACTION",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_stage_history_company_id_fkey",
          "references_table": "corev4_companies",
          "references_column": "id"
        },
        {
          "column": "contact_id",
          "on_delete": "CASCADE",
          "on_update": "NO ACTION",
          "constraint_name": "corev4_followup_stage_history_contact_id_fkey",
          "references_table": "corev4_contacts",
          "references_column": "id"
        }
      ],
      "rls_policies": [],
      "rls_policy_count": 0,
      "check_constraints": [
        {
          "check_clause": "created_at IS NOT NULL",
          "constraint_name": "2200_630756_10_not_null"
        },
        {
          "check_clause": "id IS NOT NULL",
          "constraint_name": "2200_630756_1_not_null"
        }
      ],
      "unique_constraints": []
    }
  },
  "functions": [
    {
      "language": "plpgsql",
      "arguments": "p_contact_id bigint, p_interaction_timestamp timestamp with time zone DEFAULT now()",
      "volatility": "VOLATILE",
      "return_type": "TABLE(execution_id integer, old_scheduled_at timestamp with time zone, new_scheduled_at timestamp with time zone, step_number integer)",
      "source_code": "\nDECLARE\n  v_updated_count INTEGER := 0;\nBEGIN\n  \n  -- Update last_interaction_at in contacts table\n  UPDATE corev4_contacts\n  SET \n    last_interaction_at = p_interaction_timestamp,\n    updated_at = NOW()\n  WHERE id = p_contact_id;\n\n  -- Recalculate scheduled_at for all pending followup executions\n  RETURN QUERY\n  WITH old_values AS (\n    SELECT \n      e.id,\n      e.scheduled_at as old_scheduled,\n      e.step\n    FROM corev4_followup_executions e\n    INNER JOIN corev4_followup_campaigns fc ON e.campaign_id = fc.id\n    WHERE e.contact_id = p_contact_id\n      AND e.executed = FALSE\n      AND e.should_send = TRUE\n      AND fc.should_continue = TRUE\n  ),\n  updated_executions AS (\n    UPDATE corev4_followup_executions e\n    SET \n      scheduled_at = p_interaction_timestamp + \n        (fs.wait_hours * INTERVAL '1 hour') + \n        (fs.wait_minutes * INTERVAL '1 minute'),\n      updated_at = NOW()\n    FROM \n      corev4_followup_campaigns fc,\n      corev4_followup_steps fs\n    WHERE \n      e.campaign_id = fc.id\n      AND fs.config_id = fc.config_id \n      AND fs.step_number = e.step\n      AND e.contact_id = p_contact_id\n      AND e.executed = FALSE\n      AND e.should_send = TRUE\n      AND fc.should_continue = TRUE\n    RETURNING \n      e.id,\n      e.scheduled_at as new_scheduled,\n      e.step\n  )\n  SELECT \n    ue.id as execution_id,\n    ov.old_scheduled as old_scheduled_at,\n    ue.new_scheduled as new_scheduled_at,\n    ue.step as step_number\n  FROM updated_executions ue\n  INNER JOIN old_values ov ON ue.id = ov.id;\n  \n  -- Log execution count\n  GET DIAGNOSTICS v_updated_count = ROW_COUNT;\n  \n  RAISE NOTICE 'Recalculated % followup executions for contact %', \n    v_updated_count, p_contact_id;\n    \nEND;\n",
      "function_name": "recalculate_followup_schedule"
    },
    {
      "language": "plpgsql",
      "arguments": "p_contact_id integer, p_company_id integer",
      "volatility": "VOLATILE",
      "return_type": "uuid",
      "source_code": "\nDECLARE\n    v_session_uuid UUID;\nBEGIN\n    -- Buscar session_id existente deste contato\n    SELECT session_id::uuid INTO v_session_uuid\n    FROM corev4_chat_history\n    WHERE contact_id = p_contact_id\n      AND company_id = p_company_id\n      AND session_id IS NOT NULL\n    ORDER BY created_at DESC\n    LIMIT 1;\n    \n    -- Se não existir, criar novo UUID\n    IF v_session_uuid IS NULL THEN\n        v_session_uuid := gen_random_uuid();\n    END IF;\n    \n    RETURN v_session_uuid;\nEND;\n",
      "function_name": "get_or_create_session_uuid"
    }
  ],
  "statistics": {
    "total_views": 14,
    "total_tables": 22,
    "total_indexes": 134,
    "total_triggers": 8,
    "tables_with_rls": 17,
    "total_functions": 1,
    "total_rls_policies": 2
  },
  "custom_types": {},
  "schema_metadata": {
    "scope": "corev4 complete documentation",
    "database_name": "postgres",
    "schema_version": "v4",
    "extraction_date": "2025-11-08T13:02:14.949013-03:00"
  }
}